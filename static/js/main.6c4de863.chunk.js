(this.webpackJsonpkeyboard=this.webpackJsonpkeyboard||[]).push([[0],{26:function(e,t,a){},48:function(e,t,a){},49:function(e,t,a){},52:function(e,t,a){"use strict";a.r(t);var n=a(5),r=a.n(n),c=a(18),i=a.n(c),s=(a(26),a(2)),o=a(10),l=a(21),d=a(3);var u=function(e){return Object(d.jsx)("button",{className:"btn btn-action s-circle",onClick:e.onClick,disabled:e.disabled,children:Object(d.jsx)(l.a,{icon:e.iconProp})})},m=function(e){var t=function(e){return e.toString().padStart(2,"0")},a=Math.floor(e%86400/3600),n=Math.floor(e%86400%3600/60),r=Math.floor(e%86400%3600%60);return a?a+":"+n+":"+t(r):n+":"+t(r)};var p=function(e){return Object(d.jsxs)("span",{className:"base-time",children:[m(e.time)," / ",m(e.duration)]})},b=a(6),v=function(e){Object(n.useEffect)((function(){var t=new b.c({attack:0,urls:{A0:"A0v1.mp3",C1:"C1v1.mp3","D#1":"Ds1v1.mp3","F#1":"Fs1v1.mp3",A1:"A1v1.mp3",C2:"C2v1.mp3","D#2":"Ds2v1.mp3","F#2":"Fs2v1.mp3",A2:"A2v1.mp3",C3:"C3v1.mp3","D#3":"Ds3v1.mp3","F#3":"Fs3v1.mp3",A3:"A3v1.mp3",C4:"C4v1.mp3","D#4":"Ds4v1.mp3","F#4":"Fs4v1.mp3",A4:"A4v1.mp3",C5:"C5v1.mp3","D#5":"Ds5v1.mp3","F#5":"Fs5v1.mp3",A5:"A5v1.mp3",C6:"C6v1.mp3","D#6":"Ds6v1.mp3","F#6":"Fs6v1.mp3",A6:"A6v1.mp3",C7:"C7v1.mp3","D#7":"Ds7v1.mp3","F#7":"Fs7v1.mp3",A7:"A7v1.mp3",C8:"C8v1.mp3"},baseUrl:"/keyboard/audio/",release:1,curve:"exponential",onload:function(){return e({type:"LOADED_SAMPLER",payload:{isLoaded:!0,sampler:t}})}}).toDestination()}),[e])},j=a(0),O=Object(n.createContext)({}),f={time:0,duration:0,toneState:"stopped",isLoaded:!1,sampler:void 0,disabled:!0,playbackTimeID:0},h=function(e,t){switch(t.type){case"LOADED_SAMPLER":var a=t.payload;return Object(j.a)(Object(j.a)({},e),{},{isLoaded:a.isLoaded,sampler:a.sampler});case"LOADED_MIDI":var n=t.payload;return Object(j.a)(Object(j.a)({},e),{},{duration:n.duration,time:0,disabled:!1,toneState:b.d.start().state,playbackTimeID:n.playbackTimeID});case"COUNT_TIME":return e.duration>e.time?Object(j.a)(Object(j.a)({},e),{},{time:e.time+1}):(window.clearInterval(e.playbackTimeID),Object(j.a)(Object(j.a)({},e),{},{time:0,toneState:b.d.stop().state,playbackTimeID:0}));case"PLAY_MIDI":return Object(j.a)(Object(j.a)({},e),{},{toneState:b.d.start().state,playbackTimeID:t.payload.playbackTimeID});case"PAUSE_MIDI":return window.clearInterval(e.playbackTimeID),Object(j.a)(Object(j.a)({},e),{},{toneState:b.d.pause().state,playbackTimeID:0});case"STOP_MIDI":return window.clearInterval(e.playbackTimeID),Object(j.a)(Object(j.a)({},e),{},{time:0,toneState:b.d.stop().state,playbackTimeID:0})}},y=function(){return Object(n.useContext)(O).state.sampler},D=a(19),k=function(){var e=Object(n.useContext)(O),t=e.state,a=e.dispatch,r=Object(n.useState)(!1),c=Object(s.a)(r,2),i=c[0],o=c[1],l=t.sampler,d=function(){return window.setInterval((function(){return a({type:"COUNT_TIME"})}),1e3)};return{state:Object(j.a)({isMute:i},t),handlers:{dropFile:function(e){var t=Object(s.a)(e.target.files,1)[0],n=new FileReader;n.onload=function(e){var t=new D.Midi(e.target.result);b.d.cancel(),t.tracks.forEach((function(e){new b.b((function(e,t){null===l||void 0===l||l.triggerAttackRelease(t.name,t.duration,e,t.velocity);var a=document.querySelector('[data-key-num="'.concat(function(e){return Object(b.a)(e).toMidi()}(t.name),'"]')).classList;a.add("--pressing"),setTimeout((function(){return a.remove("--pressing")}),1e3*t.duration)}),e.notes).start()})),a({type:"LOADED_MIDI",payload:{duration:Math.ceil(t.duration),playbackTimeID:d()}})},n.readAsArrayBuffer(t)},PlayPause:function(){return a("started"!==t.toneState?{type:"PLAY_MIDI",payload:{playbackTimeID:d()}}:{type:"PAUSE_MIDI"})},stop:function(){return a({type:"STOP_MIDI"})},toggleVolume:function(){if(l){var e=l.volume;e.value=i?0:e.minValue,o(!i)}}}}};var x=function(e){var t=e.usePlayer,a=(void 0===t?k:t)(),n=a.state,r=a.handlers;return Object(d.jsxs)("div",{className:"the-menu",children:[Object(d.jsx)("div",{className:"the-menu__filedrop form-group",children:Object(d.jsx)("input",{className:"form-input",type:"file",accept:"audio/midi",onChange:r.dropFile})}),Object(d.jsxs)("div",{className:"the-menu__toolbar el-cluster el-cluster--justify:flex-start",children:[Object(d.jsx)(u,{onClick:r.PlayPause,iconProp:"started"!==n.toneState?o.b:o.a,disabled:n.disabled}),Object(d.jsx)(u,{onClick:r.stop,iconProp:o.c,disabled:n.disabled}),Object(d.jsx)(u,{onClick:r.toggleVolume,iconProp:n.isMute?o.d:o.e}),Object(d.jsx)(p,{time:n.time,duration:n.duration})]})]})},I=a(20),g=(a(48),Object(I.a)(21,109)),A=function(e){return Object(b.a)(e,"midi").toNote()},C=function(e){switch((e-20)%12){case 0:case 2:case 5:case 7:case 10:return!0;default:return!1}};var _=function(e){var t=e.useSampler,a=(void 0===t?y:t)(),n=function(e){var t=e.target;t.classList.add("--pressing"),null===a||void 0===a||a.triggerAttack(A(t.dataset.keyNum))},r=function(e){var t=e.target;t.classList.remove("--pressing"),null===a||void 0===a||a.triggerRelease(A(t.dataset.keyNum))};return Object(d.jsx)("div",{className:"the-keyboard",onPointerDown:function(e){n(e);var t=e.currentTarget;t.addEventListener("pointerover",n),t.addEventListener("pointerout",r)},onPointerUp:function(e){r(e);var t=e.currentTarget;t.removeEventListener("pointerover",n),t.removeEventListener("pointerout",r)},children:g.map((function(e,t){var a=A(e);return Object(d.jsx)("div",{className:"the-keyboard__key-container",children:Object(d.jsx)("div",{className:"the-keyboard__key "+(C(e)?"--black":"--white"),"data-key-num":e,children:Object(d.jsx)("span",{className:"the-keyboard__label",children:/C[1-8]/.test(a)?a:""})})},t)}))})};var N=function(e){return Object(d.jsx)("a",{className:"base-link",href:e.url,target:"_blank",rel:"noopener noreferrer",children:e.label})};var T=function(){return Object(d.jsx)("div",{className:"the-footer-child el-center",children:Object(d.jsxs)("small",{className:"the-footer-child__container",children:[Object(d.jsx)(N,{url:"https://github.com/l1ck0h/keyboard",label:"GitHub"})," / \xa9 2022 l1ck0h"]})})};var L=function(){return Object(d.jsx)("div",{className:"el-cover",children:Object(d.jsx)("div",{className:"el-cover__centered text-center",children:Object(d.jsx)("div",{className:"loading loading-lg"})})})};a(49);var P=function(){var e=Object(n.useReducer)(h,f),t=Object(s.a)(e,2),a=t[0],r=t[1];return v(r),Object(d.jsx)("div",{className:"App",children:a.isLoaded?Object(d.jsx)(O.Provider,{value:{state:a,dispatch:r},children:Object(d.jsxs)("div",{className:"el-cover",children:[Object(d.jsx)(x,{}),Object(d.jsx)("div",{className:"el-cover__centered app-util-margin:auto",children:Object(d.jsx)(_,{})}),Object(d.jsx)(T,{})]})}):Object(d.jsx)(L,{})})},F=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,53)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;a(e),n(e),r(e),c(e),i(e)}))};a(50),a(51);i.a.render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(P,{})}),document.getElementById("root")),F()}},[[52,1,2]]]);
//# sourceMappingURL=main.6c4de863.chunk.js.map