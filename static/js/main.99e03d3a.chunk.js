(this.webpackJsonpkeyboard=this.webpackJsonpkeyboard||[]).push([[0],{54:function(e,t,n){},73:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){},81:function(e,t,n){},82:function(e,t,n){},83:function(e,t,n){},84:function(e,t,n){},85:function(e,t,n){"use strict";n.r(t);var a=n(4),r=n.n(a),i=n(16),c=n.n(i),s=(n(54),n(7)),o=n(14),u=n(113),d=n(111),l=n(110),j=n(44),b=function(e){return Object(o.a)(e,"midi").toNote()},p=0,m=function(e){return p=window.setInterval(e,1e3)},v=function(){return window.clearInterval(p)},f=(n(73),n(6));var O=function(e){var t=Object(a.useContext)(ee).appDispatch,n=Object(a.useState)("Drop a midi file here"),r=Object(s.a)(n,2),i=r[0],c=r[1],u=e.sampler,d=function(e){var n=new FileReader;n.onload=function(e){var n=new j.Midi(e.target.result);o.d.cancel(),n.tracks.forEach((function(e){new o.b((function(e,t){u.triggerAttackRelease(t.name,t.duration,e,t.velocity);var n=document.querySelector('[data-key-num="'.concat(function(e){return Object(o.a)(e).toMidi()}(t.name),'"]'));n.classList.add("pressing"),setTimeout((function(){return n.classList.remove("pressing")}),900*t.duration)}),e.notes).start()})),t({type:"setDuration",duration:Math.ceil(n.duration)}),t({type:"setTime",time:0}),t({type:"playMidi"}),m((function(){return t({type:"countTime"})})),t({type:"setDisabled",disabled:!1})},n.readAsArrayBuffer(e)};return Object(f.jsxs)("div",{id:"fileDrop",onDragEnter:function(e){return e.currentTarget.classList.add("hover")},onDragLeave:function(e){return e.currentTarget.classList.remove("hover")},onDrop:function(e){return e.currentTarget.classList.remove("hover")},children:[Object(f.jsx)("span",{id:"text",children:i}),Object(f.jsx)("input",{type:"file",accept:"audio/midi",onChange:function(e){var t=Object(s.a)(e.target.files,1)[0];c(t.name),d(t)}})]})},h=n(112),x=n(104);var y=function(){return Object(f.jsx)(h.a,{href:"https://github.com/l1ck0h/keyboard",target:"_blank",rel:"noopener noreferrer",children:Object(f.jsx)(x.a,{})})},k=(n(79),function(e){var t=Math.floor(e%86400/3600),n=Math.floor(e%86400%3600/60),a=Math.floor(e%86400%3600%60),r=n+":"+a.toString().padStart(2,"0");return t?t+":"+r:r});var g=function(e){return Object(f.jsxs)("span",{id:"time",children:[k(e.time)," / ",k(e.duration)]})},C=n(105),D=n(106);var A=function(e){return Object(f.jsx)(h.a,{disabled:e.disabled,onClick:e.onClick,children:"started"===e.state?Object(f.jsx)(C.a,{}):Object(f.jsx)(D.a,{})})},N=n(107);var S=function(e){return Object(f.jsx)(h.a,{disabled:e.disabled,onClick:e.onClick,children:Object(f.jsx)(N.a,{})})},F=n(108),w=n(109);var L=function(e){return Object(f.jsx)(h.a,{onClick:e.onClick,children:e.mute?Object(f.jsx)(F.a,{}):Object(f.jsx)(w.a,{})})};n(80);var M=function(e){var t=Object(a.useContext)(ee),n=t.appState,r=t.appDispatch,i=Object(a.useState)(!1),c=Object(s.a)(i,2),o=c[0],u=c[1];return Object(f.jsxs)("div",{id:"toolbar",children:[Object(f.jsx)(A,{state:n.toneState,disabled:n.disabled,onClick:function(){"started"!==n.toneState?(r({type:"playMidi"}),m((function(){return r({type:"countTime"})}))):r({type:"pauseMidi"})}}),Object(f.jsx)(S,{disabled:n.disabled,onClick:function(){r({type:"stopMidi"})}}),Object(f.jsx)(L,{mute:o,onClick:function(){if(e.sampler){var t=e.sampler.volume;t.value=o?0:t.minValue,u(!o)}}}),Object(f.jsx)(g,{time:n.time,duration:n.duration}),Object(f.jsx)(y,{})]})};n(81);var T=function(e){return Object(f.jsxs)("div",{id:"menu",children:[Object(f.jsx)(O,{sampler:e.sampler}),Object(f.jsx)(M,{sampler:e.sampler})]})},E=n(8),I=n(46),B=n(114),P=n(38),q=n.n(P),R=(n(82),/C[1-8]/);var z=function(e){var t=b(e.midiNote).toString();return Object(f.jsx)("div",{className:"keyboard-key",children:Object(f.jsx)("div",{className:e.isBlackKey?"black-key":"white-key","data-key-num":e.midiNote,children:Object(f.jsx)("span",{className:"key-label",children:R.test(t)?t:""})})})},J=(n(83),function(e){switch((e-20)%12){case 0:case 2:case 5:case 7:case 10:return!0;default:return!1}});var K=function(e){return Object(f.jsx)("div",{className:"keyboard-row",children:e.midiNotes.map((function(t,n){return Object(f.jsx)(z,{midiNote:t,isBlackKey:J(t)},n+e.startNum)}))})},U=Object(B.a)(21,109),V=U.length/2,_=function(e){var t=Object(I.a)(e),n=t.slice(0),a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return n.reduce((function(e,t,r){return r%a?e:[].concat(Object(E.a)(e),[n.slice(r,r+a)])}),[])}(U,U.length/2),G=Object(s.a)(_,2),H=G[0],Q=G[1];var W=function(e){var t=function(t){if(e.sampler){var n=t.target;n.dataset.keyNum&&(n.classList.add("pressing"),e.sampler.triggerAttack(b(n.dataset.keyNum)))}},n=function(t){if(e.sampler){var n=t.target;n.classList.remove("pressing"),e.sampler.triggerRelease(b(n.dataset.keyNum))}},a=function(e){0!==Array.from(document.querySelectorAll(":active")).length&&t(e)},r=function(e){n(e)};return Object(f.jsxs)("div",{id:"keyboard-container",onPointerDown:function(e){t(e);var n=e.currentTarget;n.addEventListener("pointerover",a),n.addEventListener("pointerout",r)},onPointerUp:function(e){n(e);var t=e.currentTarget;t.removeEventListener("pointerover",a),t.removeEventListener("pointerout",r)},children:[Object(f.jsx)(q.a,{query:"(min-width: 1025px)",children:Object(f.jsx)(K,{midiNotes:U,startNum:0})}),Object(f.jsxs)(q.a,{query:"(max-width: 1024px)",children:[Object(f.jsx)(K,{midiNotes:H,startNum:0}),Object(f.jsx)(K,{midiNotes:Q,startNum:V})]})]})},X=n(2),Y={time:0,duration:0,toneState:"stopped",disabled:!0},Z=function(e,t){switch(t.type){case"setTime":return Object(X.a)(Object(X.a)({},e),{},{time:t.time});case"countTime":return e.duration>e.time?Object(X.a)(Object(X.a)({},e),{},{time:e.time+1}):(v(),Object(X.a)(Object(X.a)({},e),{},{time:0,toneState:o.d.stop().state}));case"setDuration":return Object(X.a)(Object(X.a)({},e),{},{duration:t.duration});case"playMidi":return Object(X.a)(Object(X.a)({},e),{},{toneState:o.d.start().state});case"pauseMidi":return v(),Object(X.a)(Object(X.a)({},e),{},{toneState:o.d.pause().state});case"stopMidi":return v(),Object(X.a)(Object(X.a)({},e),{},{time:0,toneState:o.d.stop().state});case"setDisabled":return Object(X.a)(Object(X.a)({},e),{},{disabled:t.disabled});default:return e}},$=(n(84),Object(l.a)((function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}}))),ee=Object(a.createContext)({});var te=function(){var e=$(),t=Object(a.useState)(!0),n=Object(s.a)(t,2),r=n[0],i=n[1],c=Object(a.useState)(void 0),l=Object(s.a)(c,2),j=l[0],b=l[1],p=Object(a.useReducer)(Z,Y),m=Object(s.a)(p,2),v=m[0],O=m[1];return Object(a.useEffect)((function(){var e=new o.c({attack:0,urls:{A0:"A0v1.mp3",C1:"C1v1.mp3","D#1":"Ds1v1.mp3","F#1":"Fs1v1.mp3",A1:"A1v1.mp3",C2:"C2v1.mp3","D#2":"Ds2v1.mp3","F#2":"Fs2v1.mp3",A2:"A2v1.mp3",C3:"C3v1.mp3","D#3":"Ds3v1.mp3","F#3":"Fs3v1.mp3",A3:"A3v1.mp3",C4:"C4v1.mp3","D#4":"Ds4v1.mp3","F#4":"Fs4v1.mp3",A4:"A4v1.mp3",C5:"C5v1.mp3","D#5":"Ds5v1.mp3","F#5":"Fs5v1.mp3",A5:"A5v1.mp3",C6:"C6v1.mp3","D#6":"Ds6v1.mp3","F#6":"Fs6v1.mp3",A6:"A6v1.mp3",C7:"C7v1.mp3","D#7":"Ds7v1.mp3","F#7":"Fs7v1.mp3",A7:"A7v1.mp3",C8:"C8v1.mp3"},baseUrl:"/keyboard/audio/",release:1,onload:function(){b(e),i(!1)}}).toDestination()}),[]),Object(f.jsxs)("div",{className:"App",children:[Object(f.jsxs)(ee.Provider,{value:{appState:v,appDispatch:O},children:[Object(f.jsx)(T,{sampler:j}),Object(f.jsx)(W,{sampler:j})]}),Object(f.jsx)(u.a,{className:e.backdrop,open:r,children:Object(f.jsx)(d.a,{color:"inherit"})})]})},ne=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,116)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),i(e),c(e)}))};c.a.render(Object(f.jsx)(r.a.StrictMode,{children:Object(f.jsx)(te,{})}),document.getElementById("root")),ne()}},[[85,1,2]]]);
//# sourceMappingURL=main.99e03d3a.chunk.js.map